# Claude Manager v0.2.0 发布说明

**发布日期**: 2026-02-28
**版本**: v0.2.0
**类型**: 功能更新

## 🎉 新功能

### 双模式 AgentTest 交互

本版本为 AgentTest 功能添加了两种交互模式，让用户可以根据需求选择最合适的测试方式。

#### Chat 模式
- 💬 对话式交互界面
- 📝 消息历史记录
- ⚡ SSE 实时响应
- 🔧 一键 Prompt 优化（集成 prompt_optimizer 技能）
- 📊 清晰的消息展示（用户/助手/系统消息）

#### Terminal 模式
- 🖥️ 完整的终端模拟器（基于 xterm.js）
- 🔌 WebSocket 实时通信
- 🎨 支持 ANSI 颜色和格式
- ⌨️ 完整的终端功能（命令历史、Ctrl+C 等）
- 📂 自动切换到项目目录

#### 模式切换
- 🔄 一键切换模式
- 💾 状态自动保存
- 🎯 无缝切换体验

## 🔧 技术改进

### 前端
- 新增 `ChatView` 组件（消息列表 + 输入框）
- 新增 `TerminalView` 组件（xterm.js 集成）
- 改进 `AgentTestPanel` 支持模式切换
- 优化 SSE 连接管理
- 优化 WebSocket 连接管理

### 后端
- 新增 `/api/agent-test/terminal` WebSocket 端点
- 新增 PTY 进程管理
- 改进错误处理和日志记录
- 优化资源清理机制

## 📚 文档更新

- 新增双模式交互使用指南
- 更新 API 文档
- 新增测试报告模板

## 🐛 已知问题

1. **任务依赖解锁**: AgentTeam 任务调度中的依赖解锁逻辑存在问题（不影响核心功能）
2. **弃用警告**: 使用了 `datetime.utcnow()`，需要迁移到 `datetime.now(datetime.UTC)`

## 📊 测试结果

- ✅ 后端单元测试: 17/18 通过
- ✅ API 端点测试: 全部通过
- ⚠️ E2E 测试: 需要手动验证

详细测试报告: [v0.2.0 测试报告](../technical/20260228-01-v0.2.0测试报告.md)

## 🚀 升级指南

### 前端依赖更新

```bash
cd frontend
npm install
```

新增依赖:
- `xterm`: ^5.5.0
- `xterm-addon-fit`: ^0.10.0

### 后端无需更新

本版本后端无新增依赖。

### 数据库迁移

本版本无数据库结构变更。

## 📝 使用示例

### Chat 模式测试

1. 打开 AgentTest 页面
2. 选择一个 Agent
3. 确保模式为 "Chat"
4. 输入测试消息并发送
5. 查看实时响应

### Terminal 模式测试

1. 切换到 "Terminal" 模式
2. 等待终端加载
3. 输入命令（如 `ls`, `pwd`）
4. 查看命令输出

### 一键优化

在 Chat 模式下：
1. 输入初始 prompt
2. 点击"一键优化"按钮
3. 查看优化后的 prompt
4. 决定是否使用优化版本

## 🔮 下一步计划

### v0.2.1（修复版本）
- 修复任务依赖解锁问题
- 修复弃用警告
- 改进错误处理

### v0.3.0（功能增强）
- 添加测试历史对比功能
- 支持测试结果导出
- 添加性能监控
- 改进 UI/UX

## 🙏 致谢

感谢所有参与测试和反馈的用户！

## 📞 反馈

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- 项目讨论区

---

**完整更新日志**: [CHANGELOG.md](../../CHANGELOG.md)
