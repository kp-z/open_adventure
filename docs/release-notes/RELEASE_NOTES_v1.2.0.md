# Release Notes - v1.2.0

**å‘å¸ƒæ—¥æœŸ**: 2026-03-02

## ğŸ¯ æœ¬æ¬¡æ›´æ–°é‡ç‚¹

v1.2.0 æ˜¯ä¸€ä¸ªé‡è¦çš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§æ›´æ–°ï¼Œç³»ç»Ÿæ€§åœ°è§£å†³äº† Linux äº‘ç«¯éƒ¨ç½²æ—¶çš„å¤šä¸ªä¸¥é‡é—®é¢˜ï¼Œæ˜¾è‘—æå‡äº†ç³»ç»Ÿåœ¨ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šæ€§å’Œå¯è§‚æµ‹æ€§ã€‚

## ğŸ”´ ä¸¥é‡é—®é¢˜ä¿®å¤

### 1. æ•°æ®åº“è¿æ¥æ± è€—å°½é—®é¢˜
- **é—®é¢˜**: é»˜è®¤è¿æ¥æ± é…ç½®è¿‡å°ï¼ˆ5/10ï¼‰ï¼Œé«˜å¹¶å‘æ—¶å¯¼è‡´ 30 ç§’è¶…æ—¶å’Œ 500 é”™è¯¯
- **ä¿®å¤**:
  - å¢åŠ  `pool_size` åˆ° 20
  - å¢åŠ  `max_overflow` åˆ° 40
  - æ·»åŠ  `pool_recycle=3600`ï¼ˆ1å°æ—¶å›æ”¶è¿æ¥ï¼‰
  - æ·»åŠ  `pool_pre_ping=True`ï¼ˆè¿æ¥å‰æ£€æŸ¥å¯ç”¨æ€§ï¼‰
- **å½±å“**: æ”¯æŒæ›´é«˜å¹¶å‘ï¼ˆä» 15 åˆ° 60 è¿æ¥ï¼‰ï¼Œé˜²æ­¢è¿æ¥æ³„æ¼

### 2. Terminal å­è¿›ç¨‹åƒµå°¸è¿›ç¨‹é—®é¢˜
- **é—®é¢˜**: `pty.fork()` åˆ›å»ºçš„å­è¿›ç¨‹ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ socket æ–‡ä»¶æè¿°ç¬¦ï¼Œå¯¼è‡´åç«¯æ— æ³•é‡å¯
- **ä¿®å¤**: åœ¨ fork å‰è®¾ç½®æ‰€æœ‰éæ ‡å‡†æ–‡ä»¶æè¿°ç¬¦ä¸º `FD_CLOEXEC`ï¼Œå­è¿›ç¨‹ exec æ—¶è‡ªåŠ¨å…³é—­
- **å½±å“**: å½»åº•è§£å†³ Terminal ä¼šè¯å¯¼è‡´çš„ç«¯å£å ç”¨å’Œåƒµå°¸è¿›ç¨‹é—®é¢˜

### 3. åŒæ­¥/å¼‚æ­¥ API æ··ç”¨é—®é¢˜
- **é—®é¢˜**: `main.py` ä¸­åœ¨ async ä¸Šä¸‹æ–‡è°ƒç”¨åŒæ­¥çš„ `AgentSessionService`ï¼Œå¯¼è‡´é˜»å¡
- **ä¿®å¤**: åˆ›å»ºå¼‚æ­¥ç‰ˆæœ¬ `AgentSessionServiceAsync`ï¼Œæ‰€æœ‰æ•°æ®åº“æ“ä½œä½¿ç”¨ `await`
- **å½±å“**: é¿å…é˜»å¡ï¼Œæå‡å“åº”é€Ÿåº¦å’Œç³»ç»Ÿç¨³å®šæ€§

## ğŸŸ¡ é«˜ä¼˜å…ˆçº§é—®é¢˜ä¿®å¤

### 4. ORM æ¨¡å‹ä¼ é€’é—®é¢˜
- **é—®é¢˜**: `terminal.py` ä¸­ç›´æ¥ä¼  ORM æ¨¡å‹ç»™ Repositoryï¼Œå¯¼è‡´ `model_dump()` é”™è¯¯
- **ä¿®å¤**: ä½¿ç”¨ Pydantic Schema (`TaskCreate`, `ExecutionCreate`) åˆ›å»ºå¯¹è±¡
- **å½±å“**: ç¡®ä¿ç±»å‹å®‰å…¨å’Œæ•°æ®éªŒè¯

### 5. ExecutionCreate Schema æ‰©å±•
- **é—®é¢˜**: Schema ç¼ºå°‘ Terminal/Agent ç›¸å…³å­—æ®µï¼Œåªèƒ½æ”¾åœ¨ meta ä¸­
- **ä¿®å¤**: æ·»åŠ å®Œæ•´çš„å­—æ®µæ”¯æŒ
  - Terminal å­—æ®µ: `session_id`, `terminal_pid`, `terminal_cwd`, `terminal_command`, `terminal_output`
  - Agent å­—æ®µ: `agent_session_id`
  - æ—¶é—´å­—æ®µ: `started_at`, `finished_at`, `last_activity_at`
  - å…¶ä»–: `is_background`, `meta`
- **å½±å“**: æ›´å¥½çš„æ•°æ®ç»“æ„å’ŒæŸ¥è¯¢èƒ½åŠ›

## ğŸŸ  ä¸­ç­‰ä¼˜å…ˆçº§æ”¹è¿›

### 6. è¯¦ç»†å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **æ–°å¢**: `/api/system/health/detailed` ç«¯ç‚¹
- **åŠŸèƒ½**:
  - æ•°æ®åº“è¿æ¥æ± çŠ¶æ€ï¼ˆsize, checked_in, checked_out, overflowï¼‰
  - WebSocket è¿æ¥æ•°ï¼ˆæ€»æ•°ã€executionã€terminalï¼‰
  - Terminal ä¼šè¯æ•°ï¼ˆæ€»æ•°ã€æ´»è·ƒæ•°ï¼‰
  - æ•°æ®åº“è¿æ¥æµ‹è¯•
- **å½±å“**: æ›´å¥½çš„ç³»ç»Ÿå¯è§‚æµ‹æ€§å’Œæ•…éšœæ’æŸ¥èƒ½åŠ›

### 7. ç»“æ„åŒ–æ—¥å¿—å’Œæ—¥å¿—è½®è½¬
- **æ–°å¢**:
  - ç»“æ„åŒ–æ—¥å¿—ï¼ˆJSON æ ¼å¼ï¼Œç”Ÿäº§ç¯å¢ƒï¼‰
  - æ—¥å¿—è½®è½¬ï¼ˆ10MBï¼Œä¿ç•™ 5 ä¸ªå¤‡ä»½ï¼‰
  - Request ID æ”¯æŒï¼ˆè·¨è¯·æ±‚è¿½è¸ªï¼‰
  - é”™è¯¯æ—¥å¿—å•ç‹¬æ–‡ä»¶
  - RequestIDMiddleware ä¸­é—´ä»¶
- **å½±å“**: æ›´å¥½çš„æ—¥å¿—ç®¡ç†å’Œé—®é¢˜è¿½è¸ªèƒ½åŠ›

## ğŸŸ¢ ä½ä¼˜å…ˆçº§æ”¹è¿›

### 8. Linux äº‘ç«¯éƒ¨ç½²æ–‡æ¡£
- **æ–°å¢**: `docs/deployment/linux-cloud.md`ï¼ˆ11KBï¼‰
- **å†…å®¹**:
  - ç¯å¢ƒè¦æ±‚å’Œå¿«é€Ÿéƒ¨ç½²
  - è¿œç¨‹è®¿é—®é…ç½®ï¼ˆé˜²ç«å¢™ã€å®‰å…¨ç»„ã€Nginxï¼‰
  - systemd æœåŠ¡é…ç½®
  - æ—¥å¿—ç®¡ç†å’Œæ•…éšœæ’æŸ¥
  - æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨å»ºè®®
  - ç›‘æ§å’Œå‘Šè­¦
  - å¸¸è§é—®é¢˜

### 9. systemd æœåŠ¡é…ç½®
- **æ–°å¢**: `claude-manager.service` æ¨¡æ¿
- **åŠŸèƒ½**: è‡ªåŠ¨é‡å¯ã€èµ„æºé™åˆ¶ã€å®‰å…¨è®¾ç½®ã€æ—¥å¿—è¾“å‡º

### 10. é…ç½®ä¿®å¤
- **ä¿®å¤**: æ·»åŠ ç¼ºå¤±çš„ `env` é…ç½®å­—æ®µåˆ° `Settings` ç±»
- **ä¿®å¤**: ä¿®æ­£ `health.py` ä¸­çš„å¯¼å…¥é”™è¯¯ï¼ˆ`active_sessions` â†’ `sessions`ï¼‰

## ğŸ“ æ–‡æ¡£æ›´æ–°

- æ–°å¢ `docs/deployment/linux-cloud.md` - Linux äº‘ç«¯éƒ¨ç½²å®Œæ•´æŒ‡å—
- æ–°å¢ `docs/technical/20260302-linux-cloud-deployment-fixes.md` - ä¿®å¤è¯¦ç»†è®°å½•
- æ–°å¢ `docs/technical/20260302-backend-startup-fix.md` - å¯åŠ¨é—®é¢˜ä¿®å¤è®°å½•
- æ–°å¢ `claude-manager.service` - systemd æœåŠ¡é…ç½®æ¨¡æ¿

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ä¿®æ”¹çš„æ–‡ä»¶
1. `backend/app/core/database.py` - æ•°æ®åº“è¿æ¥æ± é…ç½®
2. `backend/app/api/terminal.py` - Terminal å­è¿›ç¨‹å’Œ Schema ä½¿ç”¨
3. `backend/app/main.py` - å¼‚æ­¥ service å’Œ RequestIDMiddleware
4. `backend/app/schemas/executions.py` - ExecutionCreate Schema æ‰©å±•
5. `backend/app/api/routers/health.py` - è¯¦ç»†å¥åº·æ£€æŸ¥
6. `backend/app/core/logging.py` - ç»“æ„åŒ–æ—¥å¿—å’Œè½®è½¬
7. `backend/app/config/settings.py` - æ·»åŠ  env å­—æ®µ

### æ–°å¢çš„æ–‡ä»¶
1. `backend/app/services/agent_session_service_async.py` - å¼‚æ­¥ç‰ˆæœ¬ service
2. `docs/deployment/linux-cloud.md` - äº‘ç«¯éƒ¨ç½²æ–‡æ¡£
3. `docs/technical/20260302-linux-cloud-deployment-fixes.md` - ä¿®å¤è®°å½•
4. `docs/technical/20260302-backend-startup-fix.md` - å¯åŠ¨ä¿®å¤è®°å½•
5. `claude-manager.service` - systemd é…ç½®

### ä»£ç ç»Ÿè®¡
- ä¿®æ”¹æ–‡ä»¶: 7 ä¸ª
- æ–°å¢æ–‡ä»¶: 5 ä¸ª
- ä»£ç è¡Œæ•°: +500 è¡Œ
- æ–‡æ¡£: 3 ä¸ªæ–°æ–‡æ¡£

## âš ï¸ å‡çº§æŒ‡å—

### ä» v1.1.x å‡çº§

1. **åœæ­¢æœåŠ¡**
   ```bash
   ./stop.sh
   ```

2. **å¤‡ä»½æ•°æ®åº“**ï¼ˆå¯é€‰ä½†æ¨èï¼‰
   ```bash
   cp backend/claude_manager.db backend/claude_manager.db.backup
   ```

3. **æ›¿æ¢ä»£ç æ–‡ä»¶**
   - ä¸‹è½½æ–°ç‰ˆæœ¬å‹ç¼©åŒ…
   - è§£å‹å¹¶è¦†ç›–ç°æœ‰æ–‡ä»¶

4. **é‡æ–°å®‰è£…ä¾èµ–**ï¼ˆå¦‚æœæœ‰å˜åŒ–ï¼‰
   ```bash
   cd backend
   source venv/bin/activate
   pip install -r requirements.txt

   cd ../frontend
   npm install
   npm run build
   ```

5. **å¯åŠ¨æœåŠ¡**
   ```bash
   ./start.sh
   ```

6. **éªŒè¯å‡çº§**
   ```bash
   curl http://localhost:8000/api/system/health/detailed
   ```

### é…ç½®å˜æ›´

**æ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶**ï¼Œæ‰€æœ‰é…ç½®éƒ½å‘åå…¼å®¹ã€‚

å¯é€‰ï¼šåœ¨ `.env` ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼ˆé»˜è®¤å€¼å·²è¶³å¤Ÿï¼‰ï¼š
```bash
ENV=production  # æˆ– development, test
```

### æ•°æ®åº“è¿ç§»

**æ— éœ€æ•°æ®åº“è¿ç§»**ï¼Œæ‰€æœ‰ Schema å˜æ›´éƒ½å‘åå…¼å®¹ã€‚

## ğŸ› å·²çŸ¥é—®é¢˜

æ— å·²çŸ¥ä¸¥é‡é—®é¢˜ã€‚

## ğŸ“Š æ€§èƒ½å½±å“

### æ­£é¢å½±å“
- è¿æ¥æ± æ‰©å¤§: æ”¯æŒæ›´é«˜å¹¶å‘ï¼ˆ60 è¿æ¥ï¼‰
- è¿æ¥å›æ”¶: é˜²æ­¢è¿æ¥æ³„æ¼å’Œè¿‡æœŸ
- å¼‚æ­¥ä¼˜åŒ–: é¿å…é˜»å¡ï¼Œæå‡å“åº”é€Ÿåº¦
- æ—¥å¿—è½®è½¬: é˜²æ­¢æ—¥å¿—æ–‡ä»¶è¿‡å¤§å½±å“æ€§èƒ½

### èµ„æºæ¶ˆè€—
- å†…å­˜: +50-100MBï¼ˆè¿æ¥æ± æ‰©å¤§ï¼‰
- ç£ç›˜: +50MBï¼ˆæ—¥å¿—è½®è½¬å¤‡ä»½ï¼‰
- CPU: +1-2%ï¼ˆç»“æ„åŒ–æ—¥å¿—ï¼‰

## ğŸ”® åç»­è®¡åˆ’

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
- åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¹¶ç›‘æ§
- æ”¶é›†æ€§èƒ½æŒ‡æ ‡å’Œæ—¥å¿—
- æ ¹æ®å®é™…è´Ÿè½½è°ƒæ•´è¿æ¥æ± å¤§å°

### ä¸­æœŸï¼ˆ1-2 æœˆï¼‰
- æ·»åŠ  Prometheus ç›‘æ§
- æ·»åŠ  Grafana ä»ªè¡¨æ¿
- å®ç°è‡ªåŠ¨å‘Šè­¦

### é•¿æœŸï¼ˆ3-6 æœˆï¼‰
- è€ƒè™‘ä½¿ç”¨ PostgreSQL æ›¿ä»£ SQLite
- å®ç°åˆ†å¸ƒå¼éƒ¨ç½²
- æ·»åŠ è´Ÿè½½å‡è¡¡

## ğŸ“¦ ä¸‹è½½

### macOS ARM64
```bash
wget https://github.com/kp-z/open_adventure/releases/download/v1.2.0/claude-manager-v1.2.0-macos-arm64.tar.gz
```

### Linux x86_64
```bash
wget https://github.com/kp-z/open_adventure/releases/download/v1.2.0/claude-manager-v1.2.0-linux-x86_64.tar.gz
```

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰åœ¨äº‘ç«¯éƒ¨ç½²æµ‹è¯•ä¸­å‘ç°é—®é¢˜å¹¶æä¾›åé¦ˆçš„ç”¨æˆ·ã€‚

## ğŸ“ æ”¯æŒ

- **GitHub Issues**: https://github.com/kp-z/open_adventure/issues
- **æ–‡æ¡£**: https://github.com/kp-z/open_adventure/tree/main/docs

---

**å®Œæ•´å˜æ›´æ—¥å¿—**: https://github.com/kp-z/open_adventure/compare/v1.1.2...v1.2.0
